/**
 * LacusSoft :: cpf-gen v1.2.0
 *
 * @author Julio L. Muller.
 * @license MIT - 2020-2021
 */

import numOnly from 'num-only';
import cpfFmt from '@lacussoft/cpf-fmt';
import mergeDeep from 'deepmerge';

var defaultOptions = {
    format: false,
    prefix: '',
};
/**
 * Merge custom options to the default ones.
 */
function mergeOptions(customOptions) {
    if (customOptions === void 0) { customOptions = {}; }
    return mergeDeep(defaultOptions, customOptions);
}

/**
 * Generate an array of random numbers (as string) between 0 and  9.
 */
function numberGenerator(length) {
    var numericSequence = [];
    while (numericSequence.length < length) {
        var random = Math.random() * 10;
        var integer = Math.floor(random);
        numericSequence.push(integer);
    }
    return numericSequence;
}

/**
 * Generate a valid CPF (Brazilian ID document) numeric sequence.
 */
function cpfGen(options) {
    var userOptions = mergeOptions(options);
    var baseSequence = numOnly(userOptions.prefix);
    var prefixLength = baseSequence.length;
    if (prefixLength < 0 || prefixLength > 9) {
        throw new Error('Option "prefix" must be a string containing between 1 and 9 digits.');
    }
    var cpfSequence = baseSequence
        .split('')
        .map(Number)
        .concat(numberGenerator(9 - prefixLength));
    [9, 10].forEach(function (nextNumIndex) {
        var factor = nextNumIndex + 1;
        var sum = 0;
        for (var n = 0; n < nextNumIndex; n++, factor--) {
            sum += cpfSequence[n] * factor;
        }
        var remainder = 11 - (sum % 11);
        cpfSequence.push(remainder > 9 ? 0 : remainder);
    });
    return userOptions.format
        ? cpfFmt(cpfSequence.join(''))
        : cpfSequence.join('');
}

export default cpfGen;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguZXNtLmpzIiwic291cmNlcyI6W10sInNvdXJjZXNDb250ZW50IjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyJ9
